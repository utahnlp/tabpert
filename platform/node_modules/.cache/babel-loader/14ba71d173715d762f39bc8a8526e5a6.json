{"ast":null,"code":"var _jsxFileName = \"/home/nupur/infotabs-extension/infotabs-code/interface/frontend/src/components/Tables.js\";\nimport React, { Component } from \"react\";\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\nimport { Container, Row, Col, Button } from \"react-bootstrap\";\nimport View from \"./View\";\n\nconst axios = require(\"axios\");\n\nclass Tables extends Component {\n  constructor(props) {\n    super(props);\n    this.onDragEnd = this.onDragEnd.bind(this);\n    this.submit = this.submit.bind(this);\n    this.addEventListeners = this.addEventListeners.bind(this);\n    this.handleInputChange = this.handleInputChange.bind(this);\n    this.state = {\n      title: \"\",\n      original: \"\",\n      A: \"\",\n      B: \"\",\n      C: \"\",\n      view: \"drag\",\n      oh: \"\",\n      ah: \"\",\n      bh: \"\",\n      ch: \"\",\n      cats: \"\"\n    };\n  }\n\n  componentDidMount() {\n    this.getTables(); // document.addEventListener(\"DOMContentLoaded\", () => {\n    //   console.log(\"dom content loaded\");\n    //   this.addEventListeners();\n    // });\n  }\n\n  addEventListeners() {\n    var draggables = document.getElementsByName(\"draggable\");\n    console.log(this);\n    draggables.forEach(function (draggable) {\n      var callback = function (event) {\n        // console.log(draggable[\"id\"]);\n        // console.log(event);\n        console.log(this.state);\n        var id = draggable[\"id\"];\n        console.log(this.state);\n        var id = draggable[\"id\"];\n        var table = id.split(\"_\")[1];\n        var key = id.split(\"_\")[2];\n        var index = id.split(\"_\")[3];\n        console.log(table);\n        console.log(this.state[\"C\"]);\n        console.log(draggable.innerText);\n        const newState = JSON.parse(JSON.stringify(this.state));\n        newState[table][key][index] = draggable.innerText;\n        this.setState(newState);\n      }.bind(this);\n\n      draggable.addEventListener(\"input\", callback);\n    }.bind(this));\n  }\n\n  handleInputChange(table, key, index, new_text) {\n    console.log(this.state);\n    console.log(this.state.table);\n    const newState = JSON.parse(JSON.stringify(this.state));\n    newState[table][key][index] = new_text;\n    this.setState(newState);\n    console.log(this.state[table][key][index]);\n  }\n\n  getTables() {\n    fetch(`/api/table?id=${this.props.tableid}`).then(res => res.json()).then(data => {\n      this.setState({\n        title: data.title,\n        original: data.original,\n        A: data.A,\n        B: data.B,\n        C: data.C,\n        oh: data.oh,\n        ah: data.ah,\n        bh: data.bh,\n        ch: data.ch\n      });\n    });\n    fetch(`/api/cats/movie`).then(res => res.json()).then(data => {\n      console.log(data);\n      this.setState({\n        cats: data\n      });\n    });\n  }\n\n  submit() {\n    console.log(this.state);\n    var title = this.state.title;\n    var A = this.state.A;\n    var B = this.state.B;\n    var C = this.state.C;\n    A[\"title\"] = title;\n    B[\"title\"] = title;\n    C[\"title\"] = title;\n    var id = this.props.tableid;\n    var ah = {};\n    var bh = {};\n    var ch = {};\n\n    for (var i = \"0\"; i < \"9\"; i++) {\n      ah[document.getElementById(\"hypothesis_A\" + i).innerText] = \"E\";\n      bh[document.getElementById(\"hypothesis_B\" + i).innerText] = \"N\";\n      ch[document.getElementById(\"hypothesis_C\" + i).innerText] = \"C\";\n    }\n\n    console.log(ah);\n    console.log(this.state);\n    axios.post(`/api/save`, {\n      title: title,\n      A: A,\n      B: B,\n      C: C,\n      id: id,\n      ah: ah,\n      bh: bh,\n      ch: ch\n    }).then(function (response) {\n      console.log(response);\n    }).catch(function (error) {//console.log(error);\n    });\n  }\n\n  reorder(list, startIndex, endIndex) {\n    console.log(list);\n    const result = Array.from(list);\n    const [removed] = result.splice(startIndex, 1);\n    result.splice(endIndex, 0, removed);\n    return result;\n  }\n\n  move(source, destination, droppableSource, droppableDestination) {\n    const sourceClone = Array.from(source);\n    const destClone = Array.from(destination);\n    const [removed] = sourceClone.splice(droppableSource.index, 1);\n    destClone.splice(droppableDestination.index, 0, removed);\n    const result = {};\n    result[droppableSource.droppableId] = sourceClone;\n    result[droppableDestination.droppableId] = destClone;\n    return result;\n  }\n\n  remove(source, droppableSource) {\n    const sourceClone = Array.from(source);\n    sourceClone.splice(droppableSource.index, 1);\n    return sourceClone;\n  }\n\n  onDragEnd(result) {\n    const {\n      source,\n      destination\n    } = result;\n    console.log(result); // dropped outside the list\n\n    if (!destination) {\n      return;\n    } // droppableIds are of the form <table_name>_<key> | trash\n\n\n    const sInd = source.droppableId;\n    const dInd = destination.droppableId;\n\n    if (dInd === \"trash\") {\n      const newSource = this.remove(this.state[sInd.split(\"_\")[0]][sInd.split(\"_\")[1]], this.state[dInd.split(\"_\")[0]][dInd.split(\"_\")[1]], source);\n      const newState = JSON.parse(JSON.stringify(this.state));\n      newState[sInd.split(\"_\")[0]][sInd.split(\"_\")[1]] = newSource;\n    } // if not the same key-category and not the same field name, drop is not allowed\n\n\n    if (sInd.split(\"_\")[1] !== dInd.split(\"_\")[1] && this.state.cats[sInd.split(\"_\")[1]] !== this.state.cats[dInd.split(\"_\")[1]]) {\n      return;\n    } // if dropped in the same place, we reorder the items\n\n\n    if (sInd === dInd) {\n      const items = this.reorder(this.state[sInd.split(\"_\")[0]][sInd.split(\"_\")[1]], source.index, destination.index);\n      const newState = JSON.parse(JSON.stringify(this.state));\n      newState[sInd.split(\"_\")[0]][sInd.split(\"_\")[1]] = items;\n      this.setState(newState);\n    } // if dropped in a different place, move\n    else {\n        const result = this.move(this.state[sInd.split(\"_\")[0]][sInd.split(\"_\")[1]], this.state[dInd.split(\"_\")[0]][dInd.split(\"_\")[1]], source, destination);\n        const newState = JSON.parse(JSON.stringify(this.state));\n        newState[sInd.split(\"_\")[0]][sInd.split(\"_\")[1]] = result[sInd];\n        newState[dInd.split(\"_\")[0]][dInd.split(\"_\")[1]] = result[dInd];\n        this.setState(newState);\n      }\n  }\n\n  render() {\n    console.log(\"We have re-rendered:\");\n    return /*#__PURE__*/React.createElement(Container, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(DragDropContext, {\n      onDragEnd: this.onDragEnd,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      className: \"justify-content-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      onClick: () => {\n        this.setState({\n          view: \"drag\"\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 13\n      }\n    }, \"Drag and Drop\"), /*#__PURE__*/React.createElement(Button, {\n      onClick: () => {\n        this.setState({\n          view: \"focusA\"\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 13\n      }\n    }, \"Focus A\"), /*#__PURE__*/React.createElement(Button, {\n      onClick: () => this.setState({\n        view: \"focusB\"\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 13\n      }\n    }, \"Focus B\"), /*#__PURE__*/React.createElement(Button, {\n      onClick: () => this.setState({\n        view: \"focusC\"\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 13\n      }\n    }, \"Focus C\"), /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 13\n      }\n    }, this.state.title)), /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(View, {\n      type: \"trash\",\n      original: this.state.original,\n      A: this.state.A,\n      B: this.state.B,\n      C: this.state.C,\n      oh: this.state.oh,\n      ah: this.state.ah,\n      bh: this.state.bh,\n      ch: this.state.ch,\n      handleInputChange: this.handleInputChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(Row, {\n      show: this.state.view === \"drag\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(View, {\n      type: this.state.view,\n      original: this.state.original,\n      A: this.state.A,\n      B: this.state.B,\n      C: this.state.C,\n      oh: this.state.oh,\n      ah: this.state.ah,\n      bh: this.state.bh,\n      ch: this.state.ch,\n      handleInputChange: this.handleInputChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(Button, {\n      onClick: this.addEventListeners,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 9\n      }\n    }, \"test\"), /*#__PURE__*/React.createElement(Button, {\n      onClick: this.submit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286,\n        columnNumber: 9\n      }\n    }, \"Submit\"));\n  }\n\n}\n\nexport default Tables;","map":{"version":3,"sources":["/home/nupur/infotabs-extension/infotabs-code/interface/frontend/src/components/Tables.js"],"names":["React","Component","DragDropContext","Droppable","Draggable","Container","Row","Col","Button","View","axios","require","Tables","constructor","props","onDragEnd","bind","submit","addEventListeners","handleInputChange","state","title","original","A","B","C","view","oh","ah","bh","ch","cats","componentDidMount","getTables","draggables","document","getElementsByName","console","log","forEach","draggable","callback","event","id","table","split","key","index","innerText","newState","JSON","parse","stringify","setState","addEventListener","new_text","fetch","tableid","then","res","json","data","i","getElementById","post","response","catch","error","reorder","list","startIndex","endIndex","result","Array","from","removed","splice","move","source","destination","droppableSource","droppableDestination","sourceClone","destClone","droppableId","remove","sInd","dInd","newSource","items","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\nimport { Container, Row, Col, Button } from \"react-bootstrap\";\nimport View from \"./View\";\n\nconst axios = require(\"axios\");\n\nclass Tables extends Component {\n  constructor(props) {\n    super(props);\n    this.onDragEnd = this.onDragEnd.bind(this);\n    this.submit = this.submit.bind(this);\n    this.addEventListeners = this.addEventListeners.bind(this);\n    this.handleInputChange = this.handleInputChange.bind(this);\n    this.state = {\n      title: \"\",\n      original: \"\",\n      A: \"\",\n      B: \"\",\n      C: \"\",\n      view: \"drag\",\n      oh: \"\",\n      ah: \"\",\n      bh: \"\",\n      ch: \"\",\n      cats: \"\",\n    };\n  }\n\n  componentDidMount() {\n    this.getTables();\n    // document.addEventListener(\"DOMContentLoaded\", () => {\n    //   console.log(\"dom content loaded\");\n    //   this.addEventListeners();\n    // });\n  }\n\n  addEventListeners() {\n    var draggables = document.getElementsByName(\"draggable\");\n    console.log(this);\n\n    draggables.forEach(\n      function (draggable) {\n        var callback = function (event) {\n          // console.log(draggable[\"id\"]);\n          // console.log(event);\n          console.log(this.state);\n          var id = draggable[\"id\"];\n          console.log(this.state);\n          var id = draggable[\"id\"];\n          var table = id.split(\"_\")[1];\n          var key = id.split(\"_\")[2];\n          var index = id.split(\"_\")[3];\n          console.log(table);\n          console.log(this.state[\"C\"]);\n          console.log(draggable.innerText);\n          const newState = JSON.parse(JSON.stringify(this.state));\n          newState[table][key][index] = draggable.innerText;\n          this.setState(newState);\n        }.bind(this);\n        draggable.addEventListener(\"input\", callback);\n      }.bind(this)\n    );\n  }\n\n  handleInputChange(table, key, index, new_text) {\n    console.log(this.state);\n    console.log(this.state.table);\n    const newState = JSON.parse(JSON.stringify(this.state));\n    newState[table][key][index] = new_text;\n    this.setState(newState);\n    console.log(this.state[table][key][index]);\n  }\n\n  getTables() {\n    fetch(`/api/table?id=${this.props.tableid}`)\n      .then((res) => res.json())\n      .then((data) => {\n        this.setState({\n          title: data.title,\n          original: data.original,\n          A: data.A,\n          B: data.B,\n          C: data.C,\n          oh: data.oh,\n          ah: data.ah,\n          bh: data.bh,\n          ch: data.ch,\n        });\n      });\n    fetch(`/api/cats/movie`)\n      .then((res) => res.json())\n      .then((data) => {\n        console.log(data);\n        this.setState({\n          cats: data,\n        });\n      });\n  }\n\n  submit() {\n    console.log(this.state);\n    var title = this.state.title;\n    var A = this.state.A;\n    var B = this.state.B;\n    var C = this.state.C;\n    A[\"title\"] = title;\n    B[\"title\"] = title;\n    C[\"title\"] = title;\n    var id = this.props.tableid;\n    var ah = {};\n    var bh = {};\n    var ch = {};\n    for (var i = \"0\"; i < \"9\"; i++) {\n      ah[document.getElementById(\"hypothesis_A\" + i).innerText] = \"E\";\n      bh[document.getElementById(\"hypothesis_B\" + i).innerText] = \"N\";\n      ch[document.getElementById(\"hypothesis_C\" + i).innerText] = \"C\";\n    }\n    console.log(ah);\n    console.log(this.state);\n\n    axios\n      .post(`/api/save`, {\n        title: title,\n        A: A,\n        B: B,\n        C: C,\n        id: id,\n        ah: ah,\n        bh: bh,\n        ch: ch,\n      })\n      .then(function (response) {\n        console.log(response);\n      })\n      .catch(function (error) {\n        //console.log(error);\n      });\n  }\n\n  reorder(list, startIndex, endIndex) {\n    console.log(list);\n    const result = Array.from(list);\n    const [removed] = result.splice(startIndex, 1);\n    result.splice(endIndex, 0, removed);\n\n    return result;\n  }\n\n  move(source, destination, droppableSource, droppableDestination) {\n    const sourceClone = Array.from(source);\n    const destClone = Array.from(destination);\n    const [removed] = sourceClone.splice(droppableSource.index, 1);\n\n    destClone.splice(droppableDestination.index, 0, removed);\n\n    const result = {};\n    result[droppableSource.droppableId] = sourceClone;\n    result[droppableDestination.droppableId] = destClone;\n\n    return result;\n  }\n\n  remove(source, droppableSource) {\n    const sourceClone = Array.from(source);\n    sourceClone.splice(droppableSource.index, 1);\n    return sourceClone;\n  }\n\n  onDragEnd(result) {\n    const { source, destination } = result;\n    console.log(result);\n\n    // dropped outside the list\n    if (!destination) {\n      return;\n    }\n\n    // droppableIds are of the form <table_name>_<key> | trash\n    const sInd = source.droppableId;\n    const dInd = destination.droppableId;\n\n    if (dInd === \"trash\") {\n      const newSource = this.remove(\n        this.state[sInd.split(\"_\")[0]][sInd.split(\"_\")[1]],\n        this.state[dInd.split(\"_\")[0]][dInd.split(\"_\")[1]],\n        source\n      );\n      const newState = JSON.parse(JSON.stringify(this.state));\n      newState[sInd.split(\"_\")[0]][sInd.split(\"_\")[1]] = newSource;\n    }\n    // if not the same key-category and not the same field name, drop is not allowed\n    if (\n      sInd.split(\"_\")[1] !== dInd.split(\"_\")[1] &&\n      this.state.cats[sInd.split(\"_\")[1]] !==\n        this.state.cats[dInd.split(\"_\")[1]]\n    ) {\n      return;\n    }\n\n    // if dropped in the same place, we reorder the items\n    if (sInd === dInd) {\n      const items = this.reorder(\n        this.state[sInd.split(\"_\")[0]][sInd.split(\"_\")[1]],\n        source.index,\n        destination.index\n      );\n      const newState = JSON.parse(JSON.stringify(this.state));\n      newState[sInd.split(\"_\")[0]][sInd.split(\"_\")[1]] = items;\n      this.setState(newState);\n    }\n    // if dropped in a different place, move\n    else {\n      const result = this.move(\n        this.state[sInd.split(\"_\")[0]][sInd.split(\"_\")[1]],\n        this.state[dInd.split(\"_\")[0]][dInd.split(\"_\")[1]],\n        source,\n        destination\n      );\n      const newState = JSON.parse(JSON.stringify(this.state));\n      newState[sInd.split(\"_\")[0]][sInd.split(\"_\")[1]] = result[sInd];\n      newState[dInd.split(\"_\")[0]][dInd.split(\"_\")[1]] = result[dInd];\n\n      this.setState(newState);\n    }\n  }\n\n  render() {\n    console.log(\"We have re-rendered:\");\n    return (\n      <Container>\n        <DragDropContext onDragEnd={this.onDragEnd}>\n          <Row className=\"justify-content-center\">\n            <Button\n              onClick={() => {\n                this.setState({ view: \"drag\" });\n              }}\n            >\n              Drag and Drop\n            </Button>\n            <Button\n              onClick={() => {\n                this.setState({ view: \"focusA\" });\n              }}\n            >\n              Focus A\n            </Button>\n            <Button onClick={() => this.setState({ view: \"focusB\" })}>\n              Focus B\n            </Button>\n            <Button onClick={() => this.setState({ view: \"focusC\" })}>\n              Focus C\n            </Button>\n            <h1>{this.state.title}</h1>\n          </Row>\n          <Row>\n            <View\n              type={\"trash\"}\n              original={this.state.original}\n              A={this.state.A}\n              B={this.state.B}\n              C={this.state.C}\n              oh={this.state.oh}\n              ah={this.state.ah}\n              bh={this.state.bh}\n              ch={this.state.ch}\n              handleInputChange={this.handleInputChange}\n            />\n          </Row>\n          <Row show={this.state.view === \"drag\"}>\n            <View\n              type={this.state.view}\n              original={this.state.original}\n              A={this.state.A}\n              B={this.state.B}\n              C={this.state.C}\n              oh={this.state.oh}\n              ah={this.state.ah}\n              bh={this.state.bh}\n              ch={this.state.ch}\n              handleInputChange={this.handleInputChange}\n            />\n          </Row>\n        </DragDropContext>\n        <Button onClick={this.addEventListeners}>test</Button>\n        <Button onClick={this.submit}>Submit</Button>\n      </Container>\n    );\n  }\n}\n\nexport default Tables;\n"]},"metadata":{},"sourceType":"module"}